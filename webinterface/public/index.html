<!DOCTYPE html>


<head>
    <meta charset="utf-8"/>

    <!-- Set the viewport width to device width for mobile -->
    <meta name="viewport" content="width=device-width" />

    <!-- Testing Google maps -->
    <style type="text/css">
        html { height: 100% }
        body { height: 100%; margin: 0; padding: 0 }
        #map_canvas { height: 100% }
    </style>


    <script type="text/javascript"
            src="https://maps.googleapis.com/maps/api/js?key=AIzaSyBwzprX4T1BWKdFM3EKEIRzxst2zEjY-84&sensor=true">
    </script>


    <!-- Script for google maps. -->
    <script type="text/javascript">
        var map;

        function initialize() {
            console.log("maps initialize run!");
            var mapOptions = {
                center: new google.maps.LatLng(40.442211, -79.946405),
                zoom: 18,
                //mapTypeId: google.maps.MapTypeId.ROADMAP
                mapTypeId: google.maps.MapTypeId.HYBRID
            };


            map = new google.maps.Map(document.getElementById("map_canvas"),
                    mapOptions);

            var marker = new google.maps.Marker({
                position: map.getCenter(),
                map: map,
                title: 'Click to zoom'
            });




        }
    </script>


    <title>Welcome to You.</title>

    <!-- Included CSS Files (Uncompressed) -->
    <!--
    <link rel="stylesheet" href="stylesheets/foundation.css">
    -->

    <!-- Included CSS Files (Compressed) -->
    <link rel="stylesheet" href="stylesheets/foundation.css">
    <link rel="stylesheet" href="stylesheets/app.css">
    <!--<link rel="stylesheet" href="stylesheets/style.css">-->

    <script src="socket.io/socket.io.js"></script>
    <!--<script src="javascripts/jquery-1.4.3.min.js"></script>-->
    <script src="javascripts/jquery-1.4.3.min.js"></script>
    <script src="javascripts/modernizr.foundation.js"></script>

    <!-- For HighCharts charting Engine -->
    <!-- Currently abandoned in favor of simpler smoothie-->
    <script src="javascripts/jquery.flot.js"></script>

    <!-- For SmoothieCharts -->
    <script src="javascripts/smoothie.js"></script>
</head>
        <!-- initialize() is for google maps -->
<body onload="initialize()">

<div class="container top-bar home-border">
    <!-- TODO: Fix links -->
    <ul class="right">
        <li class>
            <a href="templates.php">The Product</a>
        </li>
        <li>
            <a href="temp">The Goals</a>
        </li>
        <li>
            <a href="docs">Build18</a>
        </li>
        <li>
            <a href="http://github.com/msebek">GitHub</a>
        </li>
        <li class="download"><a class="small blue nice button src-download" href="download.php">Download</a></li>
    </ul>
</div>


<header>
    <div class="row">
        <div class="five columns">
            <h2 style="color:white">You. by the numbers.</h2>
        </div>

    </div>
</header>

<!-- Spacer -->
<div class="row">
    <div class="twelve columns">
        <h4></h4>
    </div>
</div>

<!-- Main content -->
<div class="row">
    <div class="four columns" style="height:100%">
        <div class="panel">
            <h4>Heartrate:</h4>

            <div class="panel" >
                <div class="large centered" style="font-size:5em; color:#73ff55" id="content">100</div>
                <!-- TODO: change colors based on what your heartrate is. -->
                <!-- TODO: Make chart, have values fall off when they get too old.-->
                <!-- TODO: add a second line, make it average-y -->
            </div>
        </div>
    </div>

    <div class="eight columns">
        <div class="panel">
            <div id="smoothieChart">
                <canvas id="mycanvas" width=600px height=200px></canvas>
            </div>
        </div>
    </div>
</div>

<div class="row">
    <!-- MAPS!!!!! -->
    <div class="panel">
            <div id="map_canvas" style="width:100%; height:300px">help</div>
    </div>
</div>



<!--<div class="four columns">


</div>-->
<div class="row">
<div class="four columns">
    <h4>Getting Started</h4>

    <p>We're stoked you want to try Foundation! To get going, this file (index.html) includes some basic styles you
        can modify, play around with, or totally destroy to get going.</p>

    <h3>Tabs</h3>
    <dl class="tabs">
        <dd class="active"><a href="#simple1">Simple Tab 1</a></dd>
        <dd><a href="#simple2">Simple Tab 2</a></dd>
        <dd><a href="#simple3">Simple Tab 3</a></dd>
    </dl>

    <ul class="tabs-content">
        <li class="active" id="simple1Tab">This is simple tab 1's content. Pretty neat, huh?</li>
        <li id="simple2Tab">This is simple tab 2's content. Now you see it!</li>
        <li id="simple3Tab">This is simple tab 3's content. It's, you know...okay.</li>
    </ul>
</div>
</div>


<div class="row">
    <div class="twelve columns">
        <h3>Orbit</h3>

        <div id="featured2">
            <img src="holder.js/1200x250/text:Slide_1" alt="slide image">
            <img src="holder.js/1200x250/text:Slide_2" alt="slide image">
            <img src="holder.js/1200x250/text:Slide_3" alt="slide image">
        </div>
    </div>
</div>


<!--<div class="row">
    <div class="twelve columns">
        <h3>Reveal</h3>

        <p><a href="#" data-reveal-id="exampleModal" class="button">Example modal</a></p>
    </div>
</div>-->

<div id="exampleModal" class="reveal-modal">
    <h2>This is a modal.</h2>

    <p>
        Reveal makes these very easy to summon and dismiss. The close button is simple an anchor with a unicode
        character icon and a class of <code>close-reveal-modal</code>. Clicking anywhere outside the modal will
        also dismiss it.
    </p>
    <a class="close-reveal-modal">Ã—</a>
</div>


<!-- Included JS Files (Compressed) -->
<script src="javascripts/foundation.min.js"></script>

<!-- Initialize JS Plugins -->
<script src="javascripts/app.js"></script>


<script>
    $(window).load(function () {
        $("#featured").orbit();
        $("#featured2").orbit();
    });
</script>

</body>
<footer>
    <!-- Socket.io script -->
    <!-- SmoothieChart script -->
    <script>
        $(document).ready(function () {
            //var socket = new io.Socket('128.237.119.135', {port: 3000, rememberTransport: false/*, transports: ['xhr-polling']*/});
            var socket = io.connect('localhost', {port:3000, rememberTransport:false});
            /* TODO: Use nonlocal host */

            //var socket = io.connect('128.237.119.135', {port: 3000, rememberTransport: false});
            var content = $('#content');

            // Set Up Smoothie Chart
            var smoothie = new SmoothieChart();
            smoothie.streamTo(document.getElementById("mycanvas"), 750);
            var line1 = new TimeSeries();
            smoothie.addTimeSeries(line1);


            socket.on('connect', function () {
                console.log('sockets connected');
                content.html("<b>Connected!</b>");

            });

            socket.on('message', function (message) {
                // Message will arrive as json.
                // format: {"hr": 46, "lat": 40.44217983624454, "lng": -79.946323193841}
                var msg = jQuery.parseJSON(message);
                var heartRate = msg["hr"];
                console.log(message);
                content.html(msg["hr"]);
                line1.append(new Date().getTime(), heartRate);

                if (msg["lat"] != 0 && msg["lng"] != 0) {
                    var latTemp = msg["lat"];
                    var longTemp = msg["lng"];
                    //assert(latTemp != 'undefined');
                    //assert(longTemp != 'undefined');
                    console.log(latTemp);
                    console.log(longTemp);
                    var marker = new google.maps.Marker({
                        position:new google.maps.LatLng(latTemp, longTemp),
                        map:map//,
                        //title:'Click to zoom'
                    });
                    map.panTo(new google.maps.LatLng(latTemp, longTemp));
                }

            });

            socket.on('disconnect', function () {
                console.log('sockets disconnected');
                content.html("<b>Disconnected!</b>");
            });

        });
    </script>

    <!-- Google maps script -->

</footer>
</html>
